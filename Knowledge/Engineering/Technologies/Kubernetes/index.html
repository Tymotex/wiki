<!doctype html><html lang=en><head><meta charset=utf-8><meta name=description content="![[Knowledge/Engineering/Technologies/assets/kubernetes-wallpaper.png|700]]
Kubernetes is an open-source container orchestrator, ie. a system for automating the deployment and [[Knowledge/Engineering/Cloud/Scaling|scaling]] of [[Knowledge/Engineering/DevOps/Containers|containers]]. The rise in popularity of microservice architectures gave rise to the need for container orchestration tools because microservices often need to be containerised."><title>Kubernetes</title><meta name=viewport content="width=device-width,initial-scale=1"><link rel="shortcut icon" type=image/png href=https://wiki.timz.dev//icon.png><link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&family=Source+Sans+Pro:wght@400;600;700&family=Fira+Code:wght@400;700&display=swap" rel=stylesheet><link href=https://wiki.timz.dev/styles.f0166864fd6bb1603db547f1f970f84b.min.css rel=stylesheet><link href=https://wiki.timz.dev/styles/_light_syntax.86a48a52faebeaaf42158b72922b1c90.min.css rel=stylesheet id=theme-link><script src=https://wiki.timz.dev/js/darkmode.773d76aedcd615c64f644f542d60cb1b.min.js></script>
<link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css integrity=sha384-R4558gYOUz8mP9YWpZJjofhk+zx0AS11p36HnD2ZKj/6JR5z27gSSULCNHIRReVs crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.js integrity=sha384-z1fJDqw8ZApjGO3/unPWUPsIymfsJmyrDVWC8Tv/a1HeOtGmkwNd/7xUS0Xcnvsx crossorigin=anonymous></script>
<script defer src=https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/contrib/auto-render.min.js integrity=sha384-+XBljXPPiv+OzfbB3cVmLHf4hdUFHlWNZN5spNQ7rmHTXpd7WvJum6fIACpNNfIR crossorigin=anonymous></script>
<script src=https://wiki.timz.dev/js/popover.688c5dcb89a57776d7f1cbeaf6f7c44b.min.js></script>
<script src=https://wiki.timz.dev/js/code-title.b35124ad8db0ba37162b886afb711cbc.min.js></script>
<script src=https://wiki.timz.dev/js/clipboard.de8d8b2221fe27323078cbd76188e364.min.js></script>
<script>const BASE_URL="https://wiki.timz.dev/",fetchData=Promise.all([fetch("https://wiki.timz.dev/indices/linkIndex.e03d960b5c1b1101ec4ff750e53fe2c3.min.json").then(e=>e.json()).then(e=>({index:e.index,links:e.links})),fetch("https://wiki.timz.dev/indices/contentIndex.badabc5a47ae4584d5dee16d0a322f8e.min.json").then(e=>e.json())]).then(([{index:e,links:t},n])=>({index:e,links:t,content:n})),render=()=>{const n=new URL(BASE_URL),s=n.pathname,o=window.location.pathname,i=s==o;addCopyButtons();const e=document.getElementById("graph-container");if(!e)return requestAnimationFrame(render);e.textContent="";const t=i&&!0;drawGraph("https://wiki.timz.dev",t,[{"/Knowledge/Engineering":"#4388cc"},{"/Knowledge/Investing":"#98c379"},{"/Knowledge/Personal-Finance":"#98c379"},{"/Knowledge/Finance":"#FFD700"},{"/Knowledge/Economics":"#FFD700"}],t?{centerForce:1,depth:3,enableDrag:!0,enableLegend:!0,enableZoom:!0,fontSize:.4,linkDistance:1,opacityScale:3,repelForce:.2,scale:1.4}:{centerForce:1,depth:2,enableDrag:!0,enableLegend:!1,enableZoom:!0,fontSize:.6,linkDistance:1,opacityScale:3,repelForce:1,scale:3}),initPopover("https://wiki.timz.dev",!0,!0)},init=(e=document)=>{addCopyButtons(),addTitleToCodeBlocks(),renderMathInElement(e.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1}],throwOnError:!1})}</script><script>window.Million={navigate:e=>window.location.href=e,prefetch:()=>{}},window.addEventListener("DOMContentLoaded",()=>{init(),render()})</script></head><script async src="https://www.googletagmanager.com/gtag/js?id=G-XYFD95KB4J"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-XYFD95KB4J",{anonymize_ip:!1})}</script><body><div id=search-container><div id=search-space><input autocomplete=off id=search-bar name=search type=text aria-label=Search placeholder="Search for something..."><div id=results-container></div></div></div><script src=https://cdn.jsdelivr.net/npm/flexsearch@0.7.21/dist/flexsearch.bundle.js integrity="sha256-i3A0NZGkhsKjVMzFxv3ksk0DZh3aXqu0l49Bbh0MdjE=" crossorigin=anonymous defer></script>
<script defer src=https://wiki.timz.dev/js/search.cf33b507388f3dfd5513a2afcda7af41.min.js></script>
<script src=https://cdn.jsdelivr.net/npm/d3@6.7.0/dist/d3.min.js integrity="sha256-+7jaYCp29O1JusNWHaYtgUn6EhuP0VaFuswhNV06MyI=" crossorigin=anonymous></script><div id=graph-container></div><style>:root{--g-node:var(--secondary);--g-node-active:var(--primary);--g-node-inactive:var(--visited);--g-link:var(--outlinegray);--g-link-active:#5a7282}</style><script src=https://wiki.timz.dev/js/graph.0ac96ed5ea296a8b1ac03a6eba11878c.js></script><div class=singlePage><header><h1 id=page-title><a href=https://wiki.timz.dev/>ðŸŒ± Tim's Dev Wiki</a></h1><svg tabindex="0" id="search-icon" aria-labelledby="title desc" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 19.9 19.7"><title id="title">Search Icon</title><desc id="desc">Icon to open search</desc><g class="search-path" fill="none"><path stroke-linecap="square" d="M18.5 18.3l-5.4-5.4"/><circle cx="8" cy="8" r="7"/></g></svg><div class=spacer></div><div class=darkmode><input class=toggle id=darkmode-toggle type=checkbox tabindex=-1>
<label id=toggle-label-light for=darkmode-toggle tabindex=-1><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" id="dayIcon" viewBox="0 0 35 35" style="enable-background:new 0 0 35 35"><title>Light Mode</title><path d="M6 17.5C6 16.672 5.328 16 4.5 16h-3C.672 16 0 16.672.0 17.5S.672 19 1.5 19h3C5.328 19 6 18.328 6 17.5zM7.5 26c-.414.0-.789.168-1.061.439l-2 2C4.168 28.711 4 29.086 4 29.5 4 30.328 4.671 31 5.5 31c.414.0.789-.168 1.06-.44l2-2C8.832 28.289 9 27.914 9 27.5 9 26.672 8.329 26 7.5 26zm10-20C18.329 6 19 5.328 19 4.5v-3C19 .672 18.329.0 17.5.0S16 .672 16 1.5v3C16 5.328 16.671 6 17.5 6zm10 3c.414.0.789-.168 1.06-.439l2-2C30.832 6.289 31 5.914 31 5.5 31 4.672 30.329 4 29.5 4c-.414.0-.789.168-1.061.44l-2 2C26.168 6.711 26 7.086 26 7.5 26 8.328 26.671 9 27.5 9zM6.439 8.561C6.711 8.832 7.086 9 7.5 9 8.328 9 9 8.328 9 7.5c0-.414-.168-.789-.439-1.061l-2-2C6.289 4.168 5.914 4 5.5 4 4.672 4 4 4.672 4 5.5c0 .414.168.789.439 1.06l2 2.001zM33.5 16h-3c-.828.0-1.5.672-1.5 1.5s.672 1.5 1.5 1.5h3c.828.0 1.5-.672 1.5-1.5S34.328 16 33.5 16zM28.561 26.439C28.289 26.168 27.914 26 27.5 26c-.828.0-1.5.672-1.5 1.5.0.414.168.789.439 1.06l2 2C28.711 30.832 29.086 31 29.5 31c.828.0 1.5-.672 1.5-1.5.0-.414-.168-.789-.439-1.061l-2-2zM17.5 29c-.829.0-1.5.672-1.5 1.5v3c0 .828.671 1.5 1.5 1.5s1.5-.672 1.5-1.5v-3C19 29.672 18.329 29 17.5 29zm0-22C11.71 7 7 11.71 7 17.5S11.71 28 17.5 28 28 23.29 28 17.5 23.29 7 17.5 7zm0 18c-4.136.0-7.5-3.364-7.5-7.5s3.364-7.5 7.5-7.5 7.5 3.364 7.5 7.5S21.636 25 17.5 25z"/></svg></label><label id=toggle-label-dark for=darkmode-toggle tabindex=-1><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" id="nightIcon" viewBox="0 0 100 100" style="enable-background='new 0 0 100 100'"><title>Dark Mode</title><path d="M96.76 66.458c-.853-.852-2.15-1.064-3.23-.534-6.063 2.991-12.858 4.571-19.655 4.571C62.022 70.495 50.88 65.88 42.5 57.5 29.043 44.043 25.658 23.536 34.076 6.47c.532-1.08.318-2.379-.534-3.23-.851-.852-2.15-1.064-3.23-.534-4.918 2.427-9.375 5.619-13.246 9.491-9.447 9.447-14.65 22.008-14.65 35.369.0 13.36 5.203 25.921 14.65 35.368s22.008 14.65 35.368 14.65c13.361.0 25.921-5.203 35.369-14.65 3.872-3.871 7.064-8.328 9.491-13.246C97.826 68.608 97.611 67.309 96.76 66.458z"/></svg></label></div></header><article><h1>Kubernetes</h1><p class=meta>Last updated September 16, 2022.</p><ul class=tags></ul><aside class=mainTOC><details open><summary>Table of Contents</summary><nav id=TableOfContents><ol><li><a href=#k8s-cluster-architecture>K8s Cluster Architecture</a><ol><li><a href=#nodes-control-planes>Nodes, Control Planes</a></li><li><a href=#kubernetes-components>Kubernetes Components</a></li></ol></li><li><a href=#service-discovery>Service Discovery</a></li><li><a href=#kubectl>Kubectl</a></li><li><a href=#under-the-hood>Under the hood</a></li></ol></nav></details></aside><p><img src=/Knowledge/Engineering/Technologies/assets/kubernetes-wallpaper.png width=700></p><p>Kubernetes is an open-source <em>container orchestrator</em>, ie. a system for automating the deployment and <a href=/Knowledge/Engineering/Cloud/Scaling rel=noopener class=internal-link data-src=/Knowledge/Engineering/Cloud/Scaling>scaling</a> of <a href=/Knowledge/Engineering/DevOps/Containers rel=noopener class=internal-link data-src=/Knowledge/Engineering/DevOps/Containers>containers</a>. The rise in popularity of microservice architectures gave rise to the need for container orchestration tools because microservices often need to be containerised. Container orchestrators like Kubernetes are meant to solve challenges arising from scaling <a href=/Knowledge/Engineering/DevOps/Containers rel=noopener class=internal-link data-src=/Knowledge/Engineering/DevOps/Containers>containers</a>. Some other technologies similar or related to Kubernetes include
<a href=https://docs.openshift.com/ rel=noopener>OpenShift</a>,
<a href=https://aws.amazon.com/ecs/ rel=noopener>Amazon ECS</a>,
<a href=https://rancher.com/ rel=noopener>Rancher</a>,
<a href=http://mesos.apache.org/ rel=noopener>Apache Mesos</a> and more.</p><p><em>Note</em>: Kubernetes and <a href=/Knowledge/Engineering/Technologies/Docker rel=noopener class=internal-link data-src=/Knowledge/Engineering/Technologies/Docker>Docker</a> are completely independent technologies. You can use Docker without Kubernetes. Kubernetes, however, needs a container runtime to orchestrate, which may or may not be Docker. It&rsquo;s just common for Docker and Kubernetes to be used together.</p><p><strong>Some background:</strong> &lsquo;Kubernetes&rsquo; originates from Greek, meaning &lsquo;helmsman&rsquo;, the person who steers a ship. K8s is an abbreviation for Kubernetes. The &lsquo;8&rsquo; is just a count of the letters between k and s.</p><p><strong>Kubernetes Features:</strong></p><ul><li>Automated <em>rollout</em> and <em>rollback</em> â€” updates are deployed automatically with care and when things go wrong, the system is rolled back to a stable state.</li><li><em>Failover</em> â€” when one container dies, another container is able to take its place, automatically.</li><li><em>Horizontal scaling</em> â€” when the load is high, then K8s will automate the creation of new containers to meet demand, and when the load is low, then containers are removed</li><li><em>Load balancing</em> by distributing work across a set of <em>pods</em>.</li></ul><a href=#k8s-cluster-architecture><h2 id=k8s-cluster-architecture><span class=hanchor arialabel=Anchor># </span>K8s Cluster Architecture</h2></a><p><img src=/Knowledge/Engineering/Technologies/assets/kubernetes-architecture.png width=800></p><a href=#nodes-control-planes><h3 id=nodes-control-planes><span class=hanchor arialabel=Anchor># </span>Nodes, Control Planes</h3></a><p>Kubernetes clusters consist of 2 types of resources: <em>nodes</em> and <em>control planes</em>.</p><ol><li><p><strong>Node</strong> â€” also called <em>worker nodes</em>. They&rsquo;re the <a href=/Knowledge/Engineering/DevOps/Virtual-Machines rel=noopener class=internal-link data-src=/Knowledge/Engineering/DevOps/Virtual-Machines>VMs</a> running the app&rsquo;s containers. Each node has a <strong>Kubelet</strong> running inside them.</p><ul><li><strong>Kubelet</strong> â€” a process running inside a node that makes it possible to talk for the node to talk to the <em>control plane</em>. They&rsquo;re responsible for telling the control plane about the health of the worker node.</li></ul></li><li><p><strong>Control plane</strong> â€” also called the <em>master node</em>. It&rsquo;s responsible for managing all activities in the cluster like scheduling, scaling, rolling out updates, etc.</p><p>A bunch of critical Kubernetes processes run within the control plane, one of which is an HTTP
<a href=https://kubernetes.io/docs/concepts/overview/kubernetes-api/ rel=noopener>Kubernetes API</a> server which the nodes use to communicate with the control plane. It&rsquo;s basically the entrypoint to the K8s cluster and Kubernetes clients talk to this server (eg. through a Kubernetes dashboard, scripts, CLIs, etc.)</p></li></ol><a href=#kubernetes-components><h3 id=kubernetes-components><span class=hanchor arialabel=Anchor># </span>Kubernetes Components</h3></a><ul><li><strong>Pods</strong> â€” a logical grouping of one or multiple containers with shared storage and network. They&rsquo;re the <em>smallest deployable units</em> of computing that you can create and manage insideÂ a worker node, which can run multiple pods within.<ul><li>It&rsquo;s common practice to run 1 container per pod.</li><li>Each pod gets its own virtual internal IP address.</li><li>Pods are ephemeral. When they die, another takes its place.
<img src="/Knowledge/Engineering/Technologies/assets/Pasted image 20220805091942.png" width=400></li></ul></li><li><strong>API server</strong> â€” the entrypoint to the K8s cluster. It serves the
<a href=https://kubernetes.io/docs/concepts/overview/kubernetes-api/ rel=noopener>Kubernetes HTTP API</a></li><li><strong>Controller Manager</strong> â€” tracks activities in cluster</li><li><strong>Scheduler</strong> â€” ensures intelligent <em>pod</em> placement based on workload and available resources</li><li><strong>etcd</strong> â€” key-value store for config and backups</li><li><strong>ConfigMap</strong> â€” contains config like database URLs that the pod can use. Makes it so that you just have to change stuff at the configmap level rather than at the application code level. It&rsquo;s not secure enough for confidential info though</li><li><strong>Secret</strong> â€” like ConfigMap, but for secret credentials</li><li><strong>Volumes</strong> â€” for data persistence. Think of it as an external hard drive plugged into the cluster
<img src=/Knowledge/Engineering/Technologies/assets/kubernetes-node-volume.png width=300></li></ul><a href=#service-discovery><h2 id=service-discovery><span class=hanchor arialabel=Anchor># </span>Service Discovery</h2></a><p>TODO.</p><p>Every <em>pod</em> gets assigned an internal IP address like <code>192.*.*.*</code>.</p><p>You can group the replicas of a service and put them behind a <a href=/Knowledge/Engineering/Architecture/Load-Balancer rel=noopener class=internal-link data-src=/Knowledge/Engineering/Architecture/Load-Balancer>load balancer</a>, for example, to expose a single cluster IP address that all other services use to talk to it.</p><p>There&rsquo;s even a DNS service that maps symbolic names to those IP addresses.</p><a href=#kubectl><h2 id=kubectl><span class=hanchor arialabel=Anchor># </span>Kubectl</h2></a><p>TODO.</p><p>This is the Kubernetes CLI.</p><p>You can</p><ul><li><code>kubectl exec -it &lt;pod> -- /bin/bash</code> to launch a shell in a pod. Useful for debugging.</li></ul><a href=#under-the-hood><h2 id=under-the-hood><span class=hanchor arialabel=Anchor># </span>Under the hood</h2></a><p>TODO.</p></article><hr><div class=page-end><div class=backlinks-container><h3>Backlinks</h3><ul class=backlinks><li><a href=/Knowledge/Engineering/SRE/Borg/ data-ctx=Kubernetes data-src=/Knowledge/Engineering/SRE/Borg class=internal-link>Borg</a></li><li><a href=/Knowledge/Engineering/Technologies/Docker/ data-ctx=Kubernetes data-src=/Knowledge/Engineering/Technologies/Docker class=internal-link>Docker</a></li><li><a href=/Knowledge/Engineering/Technologies/Docker-Compose/ data-ctx=Kubernetes data-src=/Knowledge/Engineering/Technologies/Docker-Compose class=internal-link>Docker Compose</a></li><li><a href=/Knowledge/Engineering/Technologies/Prometheus/ data-ctx=Kubernetes data-src=/Knowledge/Engineering/Technologies/Prometheus class=internal-link>Prometheus</a></li><li><a href=/Knowledge/Engineering/Technologies/Terraform/ data-ctx="K8S clusters" data-src=/Knowledge/Engineering/Technologies/Terraform class=internal-link>Terraform</a></li></ul></div></div><div id=contact_buttons><footer><ul><li><a href=/>Home</a></li><li><a href=https://timz.dev>timz.dev</a></li><li><a href=https://github.com/Tymotex/wiki>Github</a></li><li><a href=https://www.linkedin.com/in/timz-seng>LinkedIn</a></li></ul><p>Tim Zhang Â© 2023</p></footer></div></div></body></html>